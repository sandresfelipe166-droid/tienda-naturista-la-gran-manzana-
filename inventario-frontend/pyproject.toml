[tool.black]
line-length = 100
target-version = ["py311"]
skip-string-normalization = true
exclude = '''
/(
    \.git
  | \.mypy_cache
  | \.ruff_cache
  | \.venv
  | venv
  | alembic/versions
)/
'''

[tool.isort]
profile = "black"
line_length = 100
multi_line_output = 3
include_trailing_comma = true
force_grid_wrap = 0
use_parentheses = true
known_first_party = ["app", "alembic", "scripts", "tests"]
combine_as_imports = true
skip_glob = ["venv", ".venv", "alembic/versions/*"]

[tool.ruff]
line-length = 100
target-version = "py311"
respect-gitignore = true
extend-exclude = ["alembic/versions/*"]

[tool.ruff.lint]
select = [
  "E",  # pycodestyle errors
  "F",  # pyflakes
  "I",  # isort
  "UP", # pyupgrade
  "B",  # bugbear
]
ignore = [
  "E501", # line length handled by formatter
]

# Tests and scripts often have dynamic imports or looser style; reduce noise there.
[tool.ruff.lint.per-file-ignores]
"tests/**/*" = [
  "E402",  # module level import not at top (fixtures setup)
  "F401",  # imported but unused (doc fixtures, readability)
  "F811",  # redefinition (pytest param names)
  "I001",  # import sort in tests less strict
  "UP035", # typing.List/Dict in legacy test code
  "B007",  # unused loop var in tests
]
"test_*.py" = ["E402", "F401", "F811", "I001", "UP035", "B007"]
"scripts/**/*" = [
  "E402",
  "F401",
  "I001",
  "E722",  # bare except in quick scripts
  "UP035",
  "F541",  # f-string without placeholders
]
"app/routers/*.py" = [
  "B008", # FastAPI Depends in function params is idiomatic
  "I001", # Let import order be flexible for readability
]
"simple_tag_test.py" = ["F401"]

[tool.ruff.format]
quote-style = "preserve"
indent-style = "space"

[tool.pyright]
include = ["app", "scripts", "tests"]
exclude = [
  "**/__pycache__",
  "venv",
  ".venv",
  "alembic/versions",
]
venvPath = "."
reportMissingImports = "warning"
reportUnknownVariableType = "none"
reportUnknownMemberType = "none"
reportUnknownParameterType = "none"
reportUnknownArgumentType = "none"

[tool.mypy]
python_version = "3.11"
warn_unused_configs = true
ignore_missing_imports = true
allow_redefinition = true
namespace_packages = true
explicit_package_bases = true
exclude = "alembic/versions"
plugins = []
